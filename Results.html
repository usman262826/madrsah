<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>মাদরাসা ফলাফল ব্যবস্থাপনা সিস্টেম</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.maateen.me/solaiman-lipi/font.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #1a5fb4;
            --primary-dark: #1c3d78;
            --secondary-color: #26a269;
            --accent-color: #ff7800;
            --light-bg: #f8f9fa;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'SolaimanLipi', Arial, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            direction: ltr;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Main Button Styles */
        .main-btn-container {
            text-align: center;
            margin: 40px 0;
        }
        
        .main-btn {
            display: inline-block;
            background: linear-gradient(to right, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 18px 36px;
            font-size: 22px;
            font-weight: bold;
            border-radius: 50px;
            text-decoration: none;
            box-shadow: 0 6px 20px rgba(26, 95, 180, 0.3);
            transition: var(--transition);
            border: none;
            cursor: pointer;
        }
        
        .main-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(26, 95, 180, 0.4);
        }
        
        .main-btn i {
            margin-right: 10px;
        }
        
        /* Result System Container */
        .result-system {
            background: white;
            border-radius: 20px;
            box-shadow: var(--card-shadow);
            padding: 30px;
            margin-top: 30px;
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .result-system.active {
            display: block;
            opacity: 1;
        }
        
        /* Section Title */
        .section-title {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        
        .section-title h1 {
            color: var(--primary-dark);
            font-size: 36px;
            margin-bottom: 10px;
        }
        
        /* Exam Selection Cards */
        .exam-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .exam-card {
            background: var(--light-bg);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
        }
        
        .exam-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-shadow);
        }
        
        .exam-card.active {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-color: var(--primary-color);
        }
        
        .exam-card i {
            font-size: 40px;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .exam-card h3 {
            font-size: 24px;
            color: var(--primary-dark);
            margin-bottom: 10px;
        }
        
        .exam-card p {
            color: #666;
            font-size: 15px;
        }
        
        /* Form Styling */
        .search-form {
            background: var(--light-bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 40px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--primary-dark);
        }
        
        .form-control {
            width: 100%;
            padding: 14px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: var(--transition);
            background: white;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(26, 95, 180, 0.1);
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 14px 32px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 180px;
        }
        
        .btn-reset {
            background: #f1f3f4;
            color: #5f6368;
        }
        
        .btn-reset:hover {
            background: #e8eaed;
        }
        
        .btn-search {
            background: linear-gradient(to right, var(--secondary-color), #208e5c);
            color: white;
        }
        
        .btn-search:hover {
            background: linear-gradient(to right, #208e5c, var(--secondary-color));
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(38, 162, 105, 0.3);
        }
        
        .btn i {
            margin-right: 10px;
        }
        
        /* Result Display */
        .result-container {
            display: none;
            margin-top: 30px;
            animation: fadeIn 0.8s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* PDF Download Button */
        .pdf-download {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .btn-pdf {
            background: linear-gradient(to right, #d93025, #b31412);
            color: white;
            padding: 18px 40px;
            font-size: 20px;
            border-radius: 10px;
            display: inline-flex;
            align-items: center;
            box-shadow: 0 6px 20px rgba(217, 48, 37, 0.3);
        }
        
        .btn-pdf:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(217, 48, 37, 0.4);
        }
        
        /* Student Info and Result Summary */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .info-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--card-shadow);
        }
        
        .info-card h3 {
            color: var(--primary-dark);
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
            margin-bottom: 20px;
            font-size: 24px;
            display: flex;
            align-items: center;
        }
        
        .info-card h3 i {
            margin-right: 10px;
            color: var(--primary-color);
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .info-label {
            font-weight: bold;
            color: #555;
        }
        
        .info-value {
            color: #333;
            font-weight: 500;
        }
        
        /* Marks Table */
        .marks-table-container {
            overflow-x: auto;
            margin-bottom: 40px;
        }
        
        .marks-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }
        
        .marks-table th {
            background: linear-gradient(to right, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 18px;
            text-align: center;
            font-weight: bold;
        }
        
        .marks-table td {
            padding: 16px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        
        .marks-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .marks-table tr:last-child {
            font-weight: bold;
            background-color: #e8f5e9;
        }
        
        /* Error Message */
        .error-message {
            background: #ffebee;
            color: #c62828;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-top: 20px;
            display: none;
            border-left: 5px solid #c62828;
        }
        
        /* Loading Spinner */
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 30px;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .section-title h1 {
                font-size: 28px;
            }
            
            .exam-selection {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .result-system {
                padding: 20px;
            }
        }
        
        /* Bangla Number Conversion */
        .bangla-number {
            font-family: 'SolaimanLipi', Arial, sans-serif;
        }
        
        /* Footer */
        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: #666;
            font-size: 14px;
            border-top: 1px solid #eee;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Main Button -->
        <div class="main-btn-container">
            <button id="mainButton" class="main-btn">
                <i class="fas fa-graduation-cap"></i> মাদরাসার পরিক্ষার ফলাফল
            </button>
        </div>
        
        <!-- Result System -->
        <div id="resultSystem" class="result-system">
            <!-- Section 1: Title -->
            <div class="section-title">
                <h1>ব্যক্তিগত ফলাফল</h1>
                <p>আপনার পরিক্ষার ফলাফল দেখতে নিম্নের তথ্যগুলো পূরণ করুন</p>
            </div>
            
            <!-- Section 2: Exam Selection -->
            <div class="exam-selection">
                <div class="exam-card active" data-exam="প্রথম সাময়িক">
                    <i class="fas fa-file-alt"></i>
                    <h3>প্রথম সাময়িক</h3>
                    <p>প্রথম সাময়িক পরিক্ষার ফলাফল দেখুন</p>
                </div>
                
                <div class="exam-card" data-exam="দ্বিতীয় সাময়িক">
                    <i class="fas fa-file-contract"></i>
                    <h3>দ্বিতীয় সাময়িক</h3>
                    <p>দ্বিতীয় সাময়িক পরিক্ষার ফলাফল দেখুন</p>
                </div>
                
                <div class="exam-card" data-exam="বার্ষিক পরিক্ষা">
                    <i class="fas fa-award"></i>
                    <h3>বার্ষিক পরিক্ষা</h3>
                    <p>বার্ষিক পরিক্ষার ফলাফল দেখুন</p>
                </div>
            </div>
            
            <!-- Section 3: Search Form -->
            <div class="search-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="session">শিক্ষাবর্ষ</label>
                        <select id="session" class="form-control">
                            <option value="">-- শিক্ষাবর্ষ নির্বাচন করুন --</option>
                            <option value="১৪৪৪-৪৫ হিজরী/২০২৪-২৫ ঈসায়ী">১৪৪৪-৪৫ হিজরী/২০২৪-২৫ ঈসায়ী</option>
                            <option value="১৪৪৫-৪৬ হিজরী/২০২৫-২৬ ঈসায়ী" selected>১৪৪৫-৪৬ হিজরী/২০২৫-২৬ ঈসায়ী</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="jamat">জামাত নির্বাচন করুন</label>
                        <select id="jamat" class="form-control" required>
                            <option value="">-- জামাত নির্বাচন করুন --</option>
                            <option value="আতফাল (শিশু শ্রেণী)">আতফাল (শিশু শ্রেণী)</option>
                            <option value="আওয়াল (১ম শ্রেণী)">আওয়াল (১ম শ্রেণী)</option>
                            <option value="ছানী (২য় শ্রেণী)">ছানী (২য় শ্রেণী)</option>
                            <option value="ছালেছ (৩য় শ্রেণী)">ছালেছ (৩য় শ্রেণী)</option>
                            <option value="খুসুছি (ইবতেদায়ি রাবে)">খুসুছি (ইবতেদায়ি রাবে)</option>
                            <option value="খামেস (ইবতেদায়ি খামেছ)">খামেস (ইবতেদায়ি খামেছ)</option>
                            <option value="মিযান (মুতাওয়াসসিতাহ আওয়াল)">মিযান (মুতাওয়াসসিতাহ আওয়াল)</option>
                            <option value="নাহবেমীর (মুতাওয়াসসিতাহ ছানি)">নাহবেমীর (মুতাওয়াসসিতাহ ছানি)</option>
                            <option value="কুদূরী (সানাবিয়্যা আউয়াল)">কুদূরী (সানাবিয়্যা আউয়াল)</option>
                            <option value="শরহে বেকায়া (সানাবিয়্যা ছানী)">শরহে বেকায়া (সানাবিয়্যা ছানী)</option>
                            <option value="হেদায়া (ফজিলত আউয়াল)">হেদায়া (ফজিলত আউয়াল)</option>
                            <option value="মেশকাত (ফজিলত ছানী)">মেশকাত (ফজিলত ছানী)</option>
                            <option value="দাওরায়ে হাদিস (তাকমিল)">দাওরায়ে হাদিস (তাকমিল)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="regNo">রেজিস্ট্রেশন / আইডি নম্বর</label>
                        <input type="text" id="regNo" class="form-control" placeholder="রেজি. নম্বর লিখুন" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="rollNo">রোল নম্বর</label>
                        <input type="text" id="rollNo" class="form-control" placeholder="রোল নম্বর লিখুন" required>
                    </div>
                </div>
                
                <!-- Section 4: Action Buttons -->
                <div class="action-buttons">
                    <button id="resetBtn" class="btn btn-reset">
                        <i class="fas fa-redo"></i> পুনরায় সেট
                    </button>
                    <button id="searchBtn" class="btn btn-search">
                        <i class="fas fa-search"></i> অনুসন্ধান
                    </button>
                </div>
            </div>
            
            <!-- Loading Spinner -->
            <div id="loadingSpinner" class="loading-spinner">
                <div class="spinner"></div>
                <p>ফলাফল খুঁজে বের করা হচ্ছে, অনুগ্রহ করে অপেক্ষা করুন...</p>
            </div>
            
            <!-- Error Message -->
            <div id="errorMessage" class="error-message">
                <i class="fas fa-exclamation-triangle"></i>
                <p id="errorText">দুঃখিত! প্রদত্ত তথ্যের সাথে কোন ফলাফল পাওয়া যায়নি। আবার চেষ্টা করুন।</p>
            </div>
            
            <!-- Result Display -->
            <div id="resultContainer" class="result-container">
                <!-- PDF Download -->
                <div class="pdf-download">
                    <button id="downloadPdf" class="btn btn-pdf">
                        <i class="fas fa-file-pdf"></i> পিডিএফ ডাউনলোড করুন
                    </button>
                </div>
                
                <!-- Student Info and Result Summary -->
                <div class="info-grid">
                    <!-- Student Information -->
                    <div class="info-card">
                        <h3><i class="fas fa-user-graduate"></i> ছাত্রী তথ্য</h3>
                        <div id="studentInfo"></div>
                    </div>
                    
                    <!-- Result Summary -->
                    <div class="info-card">
                        <h3><i class="fas fa-chart-bar"></i> ফলাফল সারসংক্ষেপ</h3>
                        <div id="resultSummary"></div>
                    </div>
                </div>
                
                <!-- Detailed Marks Table -->
                <div class="marks-table-container">
                    <h3 style="margin-bottom: 20px; color: var(--primary-dark);">
                        <i class="fas fa-table"></i> বিস্তারিত নম্বর
                    </h3>
                    <table class="marks-table">
                        <thead>
                            <tr>
                                <th>বিষয়</th>
                                <th>পূর্ণমান</th>
                                <th>প্রাপ্ত নম্বর</th>
                            </tr>
                        </thead>
                        <tbody id="marksTableBody">
                            <!-- Marks will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            <p>© ২০২৫ মাদরাসা ফলাফল ব্যবস্থাপনা সিস্টেম | সকল অধিকার সংরক্ষিত</p>
            <p>ডিজাইন ও ডেভেলপমেন্ট: মাদরাসা আইটি বিভাগ</p>
        </div>
    </div>

    <script>
        // বাংলা সংখ্যা কনভার্টার
        const banglaNumbers = ['০', '১', '২', '৩', '৪', '৫', '৬', '৭', '৮', '৯'];
        
        function toBanglaNumber(num) {
            if (num === undefined || num === null) return '';
            return num.toString().replace(/\d/g, digit => banglaNumbers[digit]);
        }
        
        // মূল ডেটা কাঠামো
        const data = {
            selectedExam: 'প্রথম সাময়িক',
            examSheets: {
                'প্রথম সাময়িক': 'AKfycbysCMVoQCGAmStc8Md-TueWm7-LzbbHULFYP45Eb-NJNoFUgZ9RTGD1Rd8y7vJBjJjjaA',
                'দ্বিতীয় সাময়িক': '1XEaBQXReIMe2lEOWPcaY2jDu_SxIkPgOTzJluLbN42I',
                'বার্ষিক পরিক্ষা': '1XEaBQXReIMe2lEOWPcaY2jDu_SxIkPgOTzJluLbN42I'
            },
            studentInfoSheet: '1B6BzLPVKGeRosVm0p_DbMk5tssfuQTWbSF5W97-31-A',
            currentResult: null
        };
        
        // DOM লোড হওয়ার পর ইভেন্ট লিসেনার সেটআপ
        document.addEventListener('DOMContentLoaded', function() {
            // মেন বাটন ক্লিক ইভেন্ট
            document.getElementById('mainButton').addEventListener('click', function() {
                const resultSystem = document.getElementById('resultSystem');
                resultSystem.classList.add('active');
                
                // স্ক্রল এনিমেশন
                window.scrollTo({
                    top: resultSystem.offsetTop - 50,
                    behavior: 'smooth'
                });
            });
            
            // পরিক্ষা কার্ড নির্বাচন
            const examCards = document.querySelectorAll('.exam-card');
            examCards.forEach(card => {
                card.addEventListener('click', function() {
                    examCards.forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    data.selectedExam = this.getAttribute('data-exam');
                    
                    // নির্বাচিত পরিক্ষার নাম প্রদর্শন
                    const examTitle = document.querySelector('.section-title p');
                    examTitle.textContent = `${data.selectedExam} পরিক্ষার ফলাফল দেখতে নিম্নের তথ্যগুলো পূরণ করুন`;
                });
            });
            
            // রিসেট বাটন
            document.getElementById('resetBtn').addEventListener('click', function() {
                document.getElementById('session').value = '১৪৪৫-৪৬ হিজরী/২০২৫-২৬ ঈসায়ী';
                document.getElementById('jamat').value = '';
                document.getElementById('regNo').value = '';
                document.getElementById('rollNo').value = '';
                document.getElementById('resultContainer').style.display = 'none';
                document.getElementById('errorMessage').style.display = 'none';
            });
            
            // অনুসন্ধান বাটন
            document.getElementById('searchBtn').addEventListener('click', searchResult);
            
            // পিডিএফ ডাউনলোড বাটন
            document.getElementById('downloadPdf').addEventListener('click', generatePDF);
            
            // ফর্ম সাবমিশন রোধ
            document.querySelector('form').addEventListener('submit', function(e) {
                e.preventDefault();
                searchResult();
            });
            
            // ইংরেজি সংখ্যা ইনপুটকে বাংলায় রূপান্তরের জন্য ইভেন্ট লিসেনার
            document.getElementById('regNo').addEventListener('input', function(e) {
                this.value = toBanglaNumber(this.value.replace(/\D/g, ''));
            });
            
            document.getElementById('rollNo').addEventListener('input', function(e) {
                this.value = toBanglaNumber(this.value.replace(/\D/g, ''));
            });
        });
        
        // ফলাফল অনুসন্ধান ফাংশন
        async function searchResult() {
            // ফর্ম ভ্যালিডেশন
            const session = document.getElementById('session').value;
            const jamat = document.getElementById('jamat').value;
            const regNo = document.getElementById('regNo').value;
            const rollNo = document.getElementById('rollNo').value;
            
            if (!session || !jamat || !regNo || !rollNo) {
                showError('দয়া করে সকল তথ্য সঠিকভাবে পূরণ করুন।');
                return;
            }
            
            // লোডিং স্পিনার দেখান
            document.getElementById('loadingSpinner').style.display = 'block';
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('resultContainer').style.display = 'none';
            
            try {
                // ছাত্রীর প্রোফাইল তথ্য লোড করুন
                const studentInfo = await fetchStudentInfo(regNo, jamat);
                
                if (!studentInfo) {
                    showError('প্রদত্ত রেজিস্ট্রেশন নম্বরের কোন তথ্য পাওয়া যায়নি।');
                    return;
                }
                
                // পরিক্ষার ফলাফল লোড করুন
                const result = await fetchExamResult(session, jamat, regNo, rollNo);
                
                if (!result) {
                    showError('প্রদত্ত তথ্যের সাথে কোন ফলাফল পাওয়া যায়নি। আবার চেষ্টা করুন।');
                    return;
                }
                
                // ফলাফল প্রদর্শন করুন
                displayResult(studentInfo, result);
                
            } catch (error) {
                console.error('Error:', error);
                showError('সার্ভার সংযোগ সমস্যা। আবার চেষ্টা করুন।');
            } finally {
                document.getElementById('loadingSpinner').style.display = 'none';
            }
        }
        
        // ছাত্রীর তথ্য লোড করার ফাংশন
        async function fetchStudentInfo(regNo, jamat) {
            // ডেমো ডেটা - বাস্তবে গুগল শীট থেকে লোড হবে
            const demoStudentInfo = {
                '১০০১': {
                    name: 'আয়েশা সিদ্দিকা',
                    fatherName: 'মোহাম্মদ আব্দুর রহমান',
                    dob: '১৫-০৫-২০১০',
                    address: 'মোহাম্মদপুর, ঢাকা',
                    marhala: 'নাহবেমীর',
                    jamat: 'নাহবেমীর (মুতাওয়াসসিতাহ ছানি)'
                },
                '১০০২': {
                    name: 'ফাতেমা খাতুন',
                    fatherName: 'মোঃ সোলাইমান আলী',
                    dob: '২০-০৮-২০১১',
                    address: 'মিরপুর, ঢাকা',
                    marhala: 'মিযান',
                    jamat: 'মিযান (মুতাওয়াসসিতাহ আওয়াল)'
                },
                '১০০৩': {
                    name: 'মারিয়াম ইসলাম',
                    fatherName: 'মোঃ জাহিদ হাসান',
                    dob: '১২-১২-২০০৯',
                    address: 'উত্তরা, ঢাকা',
                    marhala: 'হেদায়া',
                    jamat: 'হেদায়া (ফজিলত আউয়াল)'
                }
            };
            
            // রেজি নম্বর চেক করুন
            const regNoKey = regNo.replace(/[^০-৯]/g, '');
            
            if (demoStudentInfo[regNoKey] && demoStudentInfo[regNoKey].jamat === jamat) {
                return demoStudentInfo[regNoKey];
            }
            const sheetID = '1B6BzLPVKGeRosVm0p_DbMk5tssfuQTWbSF5W97-31-A';
             const sheetURL = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json`;
            
            // বাস্তবে গুগল শীট থেকে ডেটা লোড হবে
            // const sheetID = data.studentInfoSheet;
            // const sheetURL = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json`;
            // ... গুগল শীট API কল ...
            
            return null;
        }
        
        // পরিক্ষার ফলাফল লোড করার ফাংশন
        async function fetchExamResult(session, jamat, regNo, rollNo) {
            // নির্বাচিত পরিক্ষার শীট আইডি
            const sheetID = data.examSheets[data.selectedExam];
            
            // ডেমো ডেটা - বাস্তবে গুগল শীট থেকে লোড হবে
            const demoResults = {
                '১৪৪৫-৪৬ হিজরী/২০২৫-২৬ ঈসায়ী': {
                    'নাহবেমীর (মুতাওয়াসসিতাহ ছানি)': {
                        '১০০১': {
                            '১০': {
                                session: '১৪৪৫-৪৬ হিজরী/২০২৫-২৬ ঈসায়ী',
                                regNo: '১০০১',
                                rollNo: '১০',
                                jamat: 'নাহবেমীর (মুতাওয়াসসিতাহ ছানি)',
                                marhala: 'নাহবেমীর',
                                marks: {
                                    'আরবি ব্যাকরণ': 85,
                                    'আরবি সাহিত্য': 78,
                                    'ইসলামিক স্টাডিজ': 92,
                                    'ইংরেজি': 88,
                                    'বাংলা': 90,
                                    'গণিত': 82,
                                    'সাধারন বিজ্ঞান': 76
                                },
                                total: 591,
                                average: 84.43,
                                division: 'প্রথম',
                                position: '৫ম'
                            }
                        }
                    },
                    'মিযান (মুতাওয়াসসিতাহ আওয়াল)': {
                        '১০০২': {
                            '১৫': {
                                session: '১৪৪৫-৪৬ হিজরী/২০২৫-২৬ ঈসায়ী',
                                regNo: '১০০২',
                                rollNo: '১৫',
                                jamat: 'মিযান (মুতাওয়াসসিতাহ আওয়াল)',
                                marhala: 'মিযান',
                                marks: {
                                    'আরবি ব্যাকরণ': 80,
                                    'আরবি সাহিত্য': 75,
                                    'ইসলামিক স্টাডিজ': 88,
                                    'ইংরেজি': 82,
                                    'বাংলা': 85,
                                    'গণিত': 90,
                                    'সাধারন বিজ্ঞান': 78
                                },
                                total: 578,
                                average: 82.57,
                                division: 'প্রথম',
                                position: '৮ম'
                            }
                        }
                    },
                    'হেদায়া (ফজিলত আউয়াল)': {
                        '১০০৩': {
                            '২০': {
                                session: '১৪৪৫-৪৬ হিজরী/২০২৫-২৬ ঈসায়ী',
                                regNo: '১০০৩',
                                rollNo: '২০',
                                jamat: 'হেদায়া (ফজিলত আউয়াল)',
                                marhala: 'হেদায়া',
                                marks: {
                                    'হেদায়া': 92,
                                    'তাফসীর': 88,
                                    'হাদিস': 90,
                                    'ফিকহ': 85,
                                    'উসুলুল ফিকহ': 82,
                                    'আরবি সাহিত্য': 78,
                                    'বাংলা': 90,
                                    'ইংরেজি': 80
                                },
                                total: 685,
                                average: 85.63,
                                division: 'প্রথম',
                                position: '৩য়'
                            }
                        }
                    }
                }
            };
            
            // ডেমো ডেটা থেকে ফলাফল খুঁজুন
            const regNoKey = regNo.replace(/[^০-৯]/g, '');
            const rollNoKey = rollNo.replace(/[^০-৯]/g, '');
            
            if (demoResults[session] && 
                demoResults[session][jamat] && 
                demoResults[session][jamat][regNoKey] && 
                demoResults[session][jamat][regNoKey][rollNoKey]) {
                return demoResults[session][jamat][regNoKey][rollNoKey];
            }
            
            // বাস্তবে গুগল শীট থেকে ডেটা লোড হবে
            // const sheetURL = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(jamat)}`;
            // ... গুগল শীট API কল ...
            
            return null;
        }
        
        // ফলাফল প্রদর্শন ফাংশন
        function displayResult(studentInfo, result) {
            data.currentResult = result;
            
            // ছাত্রী তথ্য প্রদর্শন
            const studentInfoHTML = `
                <div class="info-row">
                    <span class="info-label">রেজি. নং :</span>
                    <span class="info-value bangla-number">${result.regNo}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">রোল নং :</span>
                    <span class="info-value bangla-number">${result.rollNo}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">জামাত/শ্রেণী :</span>
                    <span class="info-value">${result.jamat}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">মারহালা :</span>
                    <span class="info-value">${result.marhala}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">নাম :</span>
                    <span class="info-value">${studentInfo.name}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">পিতার নাম :</span>
                    <span class="info-value">${studentInfo.fatherName}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">জন্ম তারিখ :</span>
                    <span class="info-value">${studentInfo.dob}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">ঠিকানা :</span>
                    <span class="info-value">${studentInfo.address}</span>
                </div>
            `;
            
            document.getElementById('studentInfo').innerHTML = studentInfoHTML;
            
            // ফলাফল সারসংক্ষেপ প্রদর্শন
            const resultSummaryHTML = `
                <div class="info-row">
                    <span class="info-label">মোট নাম্বার :</span>
                    <span class="info-value bangla-number">${toBanglaNumber(result.total)}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">গড় নাম্বার :</span>
                    <span class="info-value bangla-number">${toBanglaNumber(result.average.toFixed(2))}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">বিভাগ :</span>
                    <span class="info-value">${result.division}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">মেধাস্থান :</span>
                    <span class="info-value bangla-number">${result.position}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">শিক্ষাবর্ষ :</span>
                    <span class="info-value">${result.session}</span>
                </div>
            `;
            
            document.getElementById('resultSummary').innerHTML = resultSummaryHTML;
            
            // বিস্তারিত নম্বর টেবিল প্রদর্শন
            const marksTableBody = document.getElementById('marksTableBody');
            marksTableBody.innerHTML = '';
            
            let totalFullMarks = 0;
            let totalObtainedMarks = 0;
            
            Object.entries(result.marks).forEach(([subject, marks]) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${subject}</td>
                    <td class="bangla-number">${toBanglaNumber(100)}</td>
                    <td class="bangla-number">${toBanglaNumber(marks)}</td>
                `;
                marksTableBody.appendChild(row);
                
                totalFullMarks += 100;
                totalObtainedMarks += marks;
            });
            
            // মোট নাম্বার সারি
            const totalRow = document.createElement('tr');
            totalRow.innerHTML = `
                <td><strong>মোট নাম্বার</strong></td>
                <td class="bangla-number"><strong>${toBanglaNumber(totalFullMarks)}</strong></td>
                <td class="bangla-number"><strong>${toBanglaNumber(totalObtainedMarks)}</strong></td>
            `;
            marksTableBody.appendChild(totalRow);
            
            // ফলাফল কন্টেইনার প্রদর্শন করুন
            document.getElementById('resultContainer').style.display = 'block';
            document.getElementById('errorMessage').style.display = 'none';
            
            // ফলাফলে স্ক্রল করুন
            document.getElementById('resultContainer').scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
        
        // ত্রুটি বার্তা প্রদর্শন ফাংশন
        function showError(message) {
            document.getElementById('errorText').textContent = message;
            document.getElementById('errorMessage').style.display = 'block';
            document.getElementById('resultContainer').style.display = 'none';
            document.getElementById('loadingSpinner').style.display = 'none';
        }
        
        // পিডিএফ জেনারেট ফাংশন
        async function generatePDF() {
            if (!data.currentResult) return;
            
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            
            // পৃষ্ঠার সাইজ
            const pageWidth = pdf.internal.pageSize.getWidth();
            const pageHeight = pdf.internal.pageSize.getHeight();
            
            // হেডার
            pdf.setFillColor(26, 95, 180);
            pdf.rect(0, 0, pageWidth, 30, 'F');
            
            pdf.setTextColor(255, 255, 255);
            pdf.setFontSize(24);
            pdf.text('মাদরাসা ফলাফল', pageWidth / 2, 18, { align: 'center' });
            
            pdf.setFontSize(16);
            pdf.text('ব্যক্তিগত ফলাফল', pageWidth / 2, 28, { align: 'center' });
            
            // পরিক্ষার তথ্য
            pdf.setTextColor(0, 0, 0);
            pdf.setFontSize(14);
            pdf.text(`পরিক্ষার নাম: ${data.selectedExam}`, 20, 45);
            pdf.text(`শিক্ষাবর্ষ: ${data.currentResult.session}`, 20, 52);
            
            // ছাত্রী তথ্য
            pdf.setFontSize(16);
            pdf.setTextColor(26, 95, 180);
            pdf.text('ছাত্রী তথ্য', 20, 65);
            
            pdf.setDrawColor(26, 95, 180);
            pdf.line(20, 67, 80, 67);
            
            pdf.setFontSize(12);
            pdf.setTextColor(0, 0, 0);
            
            const studentInfo = document.querySelectorAll('#studentInfo .info-row');
            let yPos = 75;
            
            studentInfo.forEach(row => {
                const label = row.querySelector('.info-label').textContent.trim();
                const value = row.querySelector('.info-value').textContent.trim();
                pdf.text(`${label} ${value}`, 20, yPos);
                yPos += 7;
            });
            
            // ফলাফল সারসংক্ষেপ
            pdf.setFontSize(16);
            pdf.setTextColor(26, 95, 180);
            pdf.text('ফলাফল সারসংক্ষেপ', 120, 65);
            
            pdf.line(120, 67, 180, 67);
            
            pdf.setFontSize(12);
            pdf.setTextColor(0, 0, 0);
            
            const resultSummary = document.querySelectorAll('#resultSummary .info-row');
            yPos = 75;
            
            resultSummary.forEach(row => {
                const label = row.querySelector('.info-label').textContent.trim();
                const value = row.querySelector('.info-value').textContent.trim();
                pdf.text(`${label} ${value}`, 120, yPos);
                yPos += 7;
            });
            
            // বিস্তারিত নম্বর টেবিল
            yPos = 130;
            pdf.setFontSize(16);
            pdf.setTextColor(26, 95, 180);
            pdf.text('বিস্তারিত নম্বর', pageWidth / 2, yPos, { align: 'center' });
            
            yPos += 10;
            
            // টেবিল হেডার
            pdf.setFillColor(240, 240, 240);
            pdf.rect(20, yPos, pageWidth - 40, 10, 'F');
            
            pdf.setFontSize(12);
            pdf.setTextColor(0, 0, 0);
            pdf.text('বিষয়', 25, yPos + 7);
            pdf.text('পূর্ণমান', 100, yPos + 7);
            pdf.text('প্রাপ্ত নম্বর', 160, yPos + 7);
            
            yPos += 10;
            
            // টেবিল ডেটা
            const marksRows = document.querySelectorAll('#marksTableBody tr');
            
            marksRows.forEach((row, index) => {
                const cells = row.querySelectorAll('td');
                
                if (index % 2 === 0) {
                    pdf.setFillColor(255, 255, 255);
                } else {
                    pdf.setFillColor(248, 249, 250);
                }
                
                pdf.rect(20, yPos, pageWidth - 40, 8, 'F');
                
                const subject = cells[0]?.textContent || '';
                const fullMarks = cells[1]?.textContent || '';
                const obtainedMarks = cells[2]?.textContent || '';
                
                pdf.text(subject, 25, yPos + 6);
                pdf.text(fullMarks, 100, yPos + 6);
                pdf.text(obtainedMarks, 160, yPos + 6);
                
                yPos += 8;
                
                // নতুন পৃষ্ঠা চেক করুন
                if (yPos > pageHeight - 30) {
                    pdf.addPage();
                    yPos = 20;
                }
            });
            
            // ফুটার
            pdf.setFontSize(10);
            pdf.setTextColor(100, 100, 100);
            pdf.text('© ২০২৫ মাদরাসা ফলাফল ব্যবস্থাপনা সিস্টেম', pageWidth / 2, pageHeight - 10, { align: 'center' });
            
            // পিডিএফ ডাউনলোড
            const fileName = `result_${data.currentResult.regNo}_${data.selectedExam}.pdf`;
            pdf.save(fileName);
        }
    </script>
</body>
</html>